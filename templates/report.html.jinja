{% extends "layout/default.html.jinja" %}

{% block content %}
<div class="responsive-prose">
    <h1>
        Monthly GTFS Quality Report
        <br>
        <small class="text-gray-600">
            for <a href="{{ feed_info.feed_publisher_url }}">{{ feed_info.feed_publisher_name }}</a>
            &middot;
            {{ date_generated }}
        </small>
    </h1>
    <p class="lead responsive-prose">
        This is a monthly report, generated by the California Integrated Travel Project
        (Cal-ITP), summarizing issues discovered by MobilityDataâ€™s GTFS Validator. This report
        is available for viewing by the general public to support continuous improvement of
        GTFS data and the experience of transit passengers.
    </p>
</div>

<div class="my-8">
    <a class="btn responsive-prose" href="{{ status.gtfs_schedule_url }}">Download Feed</a>
    &emsp;
    <span class="text-gray-400">{{ status.gtfs_schedule_url }}</span>
</div>

<hr>

<div class="flex gap-12">
    <div class="flex-1 responsive-prose">
        <h2>Overview</h2>
        <ul>
            <li>Date published: {{ feed_info.feed_version }}</li>
            <li>Number of routes in any service: {{ feed_info.n_routes }}</li>
            <li>Number of stops in service: {{ feed_info.n_stops }}</li>
        </ul>
    </div>

    <div class="flex-1 responsive-prose">
        <h2>Aggregated metrics for&nbsp;[Month]</h2>
        <ul>
            <li>Days when the active feed was expired: {{ n_expired_days.n }}</li>
            <li>Service hours per day in the active feed: </li>
        </ul>
    </div>

    <div class="flex-1 responsive-prose">
        <h2>Changes since the previous&nbsp;month</h2>
        <ul>
            <li>Percentage of stop and route IDs that have changed since the previous month.</li>
            <li>More than 5% being new or dropped is a cause for attention.</li>
        </ul>
    </div>
</div>

<hr>

<div class="responsive-prose max-w-none">
    <h2>
        Consistency with the California GTFS Minimum Guidelines
        <br>
        <small class="text-gray-600">for feed downloaded {{ feed_info.feed_end_date }}</small>
    </h2>

    <table>
        <thead>
            <tr>
                <th colspan="2">Do the following files/fields exist?</th>
                <th>[First Date]</th>
                <th>[Second Date]</th>
                <th>[Third Date]</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <th>Visual display</th>
                <td>shapes.txt</td>
                <td><i title="check" class="fas fa-check-circle text-green-500"></i></td>
                <td><i title="check" class="fas fa-check-circle text-green-500"></i></td>
                <td><i title="check" class="fas fa-check-circle text-green-500"></i></td>
            </tr>
            <tr>
                <th rowspan="2">Navigation</th>
                <td>pathways.txt</td>
                <td><i title="check" class="fas fa-check-circle text-green-500"></i></td>
                <td><i title="check" class="fas fa-check-circle text-green-500"></i></td>
                <td><i title="check" class="fas fa-check-circle text-green-500"></i></td>
            </tr>
            <tr>
                <td>levels.txt</td>
                <td><i title="check" class="fas fa-check-circle text-green-500"></i></td>
                <td><i title="check" class="fas fa-check-circle text-green-500"></i></td>
                <td><i title="check" class="fas fa-check-circle text-green-500"></i></td>
            </tr>
            <tr>
                <th rowspan="2">Fares</th>
                <td>Fare_rules.txt</td>
                <td><i title="check" class="fas fa-check-circle text-green-500"></i></td>
                <td><i title="check" class="fas fa-check-circle text-green-500"></i></td>
                <td><i title="check" class="fas fa-check-circle text-green-500"></i></td>
            </tr>
            <tr>
                <td>Fare_leg_rules.txt</td>
                <td><i title="check" class="fas fa-check-circle text-green-500"></i></td>
                <td><i title="check" class="fas fa-check-circle text-green-500"></i></td>
                <td><i title="check" class="fas fa-check-circle text-green-500"></i></td>
            </tr>
        </tbody>
    </table>
</div>
{% endblock %}
